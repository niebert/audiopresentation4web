<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
  <meta http-equiv="content-language" content="de">
  <meta http-equiv="desktop-type" content="tasks">
  <!-- END:   src/html/header.html -->
  <script language="javascript">
   // vDataJSON is the main JSON storage for the privacy friendly WebApp
   // File Loaded into vDataJSON by script tag
   var vDataJSON = {};
   vDataJSON.tpl = {};
   /* TEMPLATES
   vDataJSON.tpl contains the following templates:
     * vDataJSON.tpl["javascript"] File: tpl/javascript_tpl.js
       for creating the the Source Code for the UML class in javascript
     * vDataJSON.tpl["docu4github"] File: tpl/docu4github_tpl.js
       for creating the GitHub documentation from the UML source of the class
   */

   vDataJSON.out = {};
   /* HANDLEBARS COMPILERS
   vDataJSON.tpl contains the Handlebars compilers:
     * vDataJSON.out["javascript"] Compiler for template: tpl/javascript_tpl.js
       This compiler is used in the compileCode() method
       var mySource = vJSONEditor.compileCode.javascript(pJSON)
       creates the source code for the UML class in javascript
     * vDataJSON.out["docu4github"] Compiler for template: tpl/docu4github_tpl.js
       This compiler is used in the compileCode() method
       var mySource = vJSONEditor.compileCode.docu4github(pJSON)
   */
   vDataJSON.files = {
     "audio":[],
     "image":[]
   };

  </script>
  <!-- ### Data JSON Loaded File  ##################### -->
  <script src="db/data.js"></script>
  <!-- ### HANDLEBARS TEMPLATE  #####################
  Template ID: "audioslides"
  Template: vDataJSON["tpl"]["audioslides"]
  -->
  <script src="tpl/audioslides_tpl.js"></script>

<!--

  <script src="js/linkparam.js"></script>
  <script src="js/filesaver.js"></script>
  <script src="js/canvas2blob.js"></script>
  <script src="js/dom2id.js"></script>
  <script src="js/date_time.js"></script>
  <script src="js/jszip.js"></script>
  <script src="js/linkparam.js"></script>
  <script src="js/handlebars4code.js"></script>
  <script src="js/loadfile4dom.js"></script>
  <script src="js/jszip.js"></script>

-->
  <script src="js/jszip.js"></script>
  <script src="js/audioslides4web.js"></script>
  <script language="javascript">
    var zip = new JSZip();
    /* ZIP File
    The Audio Slide presentation is a bundle of multiple files
    organised in folders with:
       * HTML files
       * TXT files with folders information
       * Audio Files in folder /audio
       * Images with single slides in folder /images
    The folder structure is generated by audioslides for web
    */
  </script>

    <script>

      //-----------------------------------------------
      //---- LoadFile4DOM -----------------------------
      //-----------------------------------------------
      var lf4d = new LoadFile4DOM();
      var options = {
        "debug": false // if true, it will show the hidden <input type="file" ...> loaders in DOM
      };
      lf4d.init(document,options);
      //-----------------------------------------------
      //----- Create a new Loader "file2image" --------
      //-----------------------------------------------
      var file2image = lf4d.get_loader_options("addfile2image","image_thumb");
      file2image.returntype = "tag";
      file2image.width = 300;
      file2image.multiple = true;
      // Define what to do with the loaded data
      file2image.onload = function (data,err) {
        if (err) {
          // do something on error, perr contains error message
          console.error(err);
        } else {
          // do something with the file content in data e.g. store  in a HTML textarea (e.g. <textarea id="mytextarea" ...>
          console.log("CALL: file2image.onload('" + data.name + "')");
          var vNode = document.getElementById("outimage");
          if (vNode) {
            //console.log("CALL: file2image.onload('" + data.name + "'): "+JSON.stringify(data,null,4));
            var arr_img = vDataJSON.files.image;
            vNode.innerHTML = vNode.innerHTML + "<li>Slide " + extract_number(data.name,arr_img.length)+ ": <tt>" + data.name + "</tt><br>" + data.tag + "</li>";
            arr_img.push(data);
            //zip.file(data.name, data.file, {base64: true})
            setSlideCount();
          } else {
            console.error("ERROR: DOM Element 'outimage' does not exist!");
          }
        }
      };
      // create the load dialog 'file2image'
      lf4d.create_load_dialog(file2image);
      //-----------------------------------------------
      //----- Create a new Loader "file2audio" --------
      //-----------------------------------------------
      var file2audio = lf4d.get_loader_options("addfile2audio","audio");
      file2audio.returntype = "filehash";
      // Define what to do with the loaded data
      file2audio.onload = function (data,err) {
        if (err) {
          // do something on error, perr contains error message
          console.error(err);
        } else {
          // do something with the file content in data e.g. store  in a HTML textarea (e.g. <textarea id="mytextarea" ...>
          console.log("CALL: file2audio.onload('" + data.name + "')");
          var vNode = document.getElementById("outaudio");
          if (vNode) {
            //console.log("CALL: file2audio.onload('" + data.name + "'): "+JSON.stringify(data,null,4));
            var arr_audio = vDataJSON.files.audio;
            vNode.innerHTML = vNode.innerHTML + "<li>Audio " + extract_number(data.name,arr_audio.length)+ ": <tt>" + data.name + "</tt> </li>";
            arr_audio.push(data);
            setSlideCount();
            //zip.file(data.name, data.file, {base64: true})
        } else {
            console.error("ERROR: DOM Element 'outlist' does not exist!");
          }
        }
      };
      // create the load dialog 'file2audio'
      lf4d.create_load_dialog(file2audio);
      //-----------------------------------------------
    </script>
</head>
<body onload="lf4dom.create()" style="margin:10px;background:#C0C0C0;font-family:Arial,Helvetica,sans-serif">

    <hr>
      <center>
        <h2>Audio Slides for Web</h2>
        <h3><i>based on Library: <a href="https://www.npmjs.com/package/jszip" target="_blank">jszip NPM</a></i></h3>
      </center>
    <hr>
    <center>
      <p>
        <a href="https://www.github.com/niebert/audioSlides4web" target="_blank">AudioSlides4Web</a> was created as a online alternative for <a href="https://en.wikiversity.org/wiki/PanDocElectron" target="_blank">PanDocElectron</a>.
        See <a href="https://en.wikiversity.org/wiki/PanDocElectron/AudioSlides4Web" target="_blank">AudioSlides4Web in Wikiversity</a> for further details. It is necessary to copy you audio files in the subfolder <tt>/audio/</tt> and the slides e.g. as PNG-images into the folder <tt>/images/</tt>.
        Adapt the basename of your audio files and images to the base name in the interface below.
      </p>
    </center>
<center>
  <form action="audioslide.html" target="_blank">
    <table border="1">
      <tr>
        <td>
          <b>Title</b><input type="text" id="tUndefined" value="ERROR" style="display:none">
        </td>
        <td>
          <input type="text" size="80" name="title" id="tTitle" value="My Presentation Title">
        </td>
      </tr>
      <tr>
        <td>
          <b>Course</b>
        </td>
        <td>
          <input type="text" size="80" name="course" id="tCourse" value="Ecotoxicology">
        </td>
      </tr>
      <tr>
        <td>
          <b>Author</b>
        </td>
        <td>
          <input type="text" size="80" name="author" id="tAuthor" value="My Name">
        </td>
      </tr>
      <tr>
        <td>
          <b>Date</b>
        </td>
        <td>
          <input type="text" size="80" name="date" id="tDate" value="00.00.00">
        </td>
      </tr>
      <tr style="display:none">
          <td>
            <b>Audio Slides</b>
          </td>
          <td>
            <select name="audioslide" id="sAudioSlide">
              <option value="yes">Use Player for Audio Slides</option>
              <option value="no">NO Audio Slides</option>
            </select>
          </td>
      </tr>
      <tr>
        <td>
          <b>Slide Index</b>
        </td>
        <td>
          First Index: <input type="text" size="4" name="first" id="tFirst" value="0">
          Last Index: <input type="text" size="4" name="last" id="tLast" value="40">
        </td>
      </tr>
      <tr>
        <td>
          <b>Slide Image Files</b>
        </td>
        <td>
          Basename: <tt>/images/</tt><input type="text" size="10" name="imagebasename" id="tImageBaseName" value="img">.<input type="text" size="3" name="imageext" id="tImageExt" value="png">
        </td>
      </tr>
        <tr>
        <td>
          <b>Audio Files</b>
        </td>
        <td>
          Basename: <tt>/audio/</tt><input type="text" size="10" name="audiobasename" id="tAudioBaseName" value="audio">.<input type="text" size="3" name="audioext" id="tAudioExt" value="mp3"> Type:
          <input type="text" size="4" name="audiotype" id="tAudioType" value="mpeg">
        </td>
      </tr>
      <tr>
        <td>
          <b>Filename</b>
        </td>
        <td>
          <input type="text" size="30" name="filename" id="tFileName" value="audio_slides">
        </td>
      </tr>
      <tr>
        <td>
          <b>Audio Slides:</b>
        </td>
        <td>
          <!--
          <input type="button" id="bSource" value="Download Slides" onclick="callSource();return false">
          -->
          <button onclick="lf4d.open_dialog('addfile2image');return false">Add Slides</button>
          <button onclick="lf4d.open_dialog('addfile2audio');return false">Add Audio </button>
          <button onclick="reset_ZIP();return false">Reset</button> -
          <input type="button" id="bSourceZIP" value="Download Audiopresentation ZIP" onclick="callSourceZIP();return false" -->
          <!-- input type="submit" id="bSubmit" value="Download Presentation" -->
        </td>
      </tr>
    </table>
    </form>

<br>

    <table border="1">
      <tr>
        <td align="center">
          <b>Added Image</b>
        </td>
        <td align="center">
          <b>Added Audio</b>
        </td>
      </tr>
      <tr>
        <td valign="top">
          <ul id="outimage">
          </ul>
        </td>
        <td valign="top">
          <ul id="outaudio">
          </ul>
        </td>
      </tr>

    </table>
</center>

<!-- BEGIN: src/html/bodytail.html -->
<!-- END:   src/html/bodytail.html -->

	   <!-- BEGIN: src/html_tail.html -->
	   <center style="font-size: 10px;">
			  <a href="https://github.com/niebert/AudioSlides4Web" target="_blank"> GitHub Sources AudioSlides4Web</a> - <a href="https://github.com/niebert/AudioSlides4Web/archive/master.zip"  target="_blank">Download AudioSlides4Web ZIP</a>
			  <br>
			  Version: 1.2.0 Date: 2019/01/09 17:18:13 Author: Engelbert Niehaus
	   </center>
     <!-- END:  src/html_tail.html -->

	<script language="javascript">
    //---------------------------------------
    //---COMPILE TEMPLATES Handlebars4Code---
    //---------------------------------------
    Handlebars4Code.create_compiler(vDataJSON.tpl);
    vDataJSON.out = Handlebars4Code.get_compiler();


    //---------------------------------------
    //------READ LINKPARAMETER---------------
    //---------------------------------------
    var vLinkParam = new LinkParam();
    vLinkParam.init(document);
    //------ POPULATE JSON ------------------
    var vJSON = vDataJSON.initdata;
    for (var id in vDOM2ID) {
      if (vDOM2ID.hasOwnProperty(id)) {
        if (vLinkParam.exists(vDOM2ID[id])) {
          var id4JSON = getJSONID(id);
          //vJSON["title"] = vLinkParam.getValue(vDOM2ID["tTitle"]);
          switch (id) {
            case "tFirst":
              vJSON[id4JSON] = getInteger(vLinkParam.getValue(vDOM2ID[id]));
            break;
            case "tLast":
              vJSON[id4JSON] = getInteger(vLinkParam.getValue(vDOM2ID[id]));
            break;
            default:
              vJSON[id4JSON] = vLinkParam.getValue(vDOM2ID[id]);
          }
        }
      }
    }
    el("tDate").value = getDateTime();

</script>
<!-- BEGIN: src/html/tail.html -->
  </body>
</html>
<!-- END:   src/html/tail.html -->
